/*!
 * Testimonial.js v0.0.1 - 2014-05-06 
 * Homepage: https://github.com/AlekseyLeshko/testimonial.js
 * Author: Aleksey Leshko (https://github.com/AlekseyLeshko)
 * Copyright 2014
 * Licensed under MIT (https://github.com/AlekseyLeshko/testimonial.js/blob/master/LICENSE)
 */
Parser=function(a){this.$nodeArr=a,this.dataArr=[]},Parser.prototype={parse:function(){for(var a=0;a<this.$nodeArr.length;a++){var b=$(this.$nodeArr[a]);this.parseNode(b)}return this.dataArr},parseNode:function(a){var b=this.parseAuthorNode(a.children(".author"));b.quote=a.children(".quote").text().trim(),this.dataArr.push(b)},parseAuthorNode:function(a){var b=a.children(".full_name"),c=a.children(".company"),d={fullName:b.text().trim(),authorHref:this.getAttrHrefOrDefault(b.children("a")),company:c.text().trim(),companyHref:this.getAttrHrefOrDefault(c.children("a")),fotoSrc:a.children(".foto").attr("src")};return d},getAttrHrefOrDefault:function(a){var b=a.attr("href");return void 0===b&&(b="#"),b}},Testimonial=function(a,b){this.$container=a,this.pluginOptions={},this.$slides=[],this.dataArr=[],this.currentSlideIndex=0,this.initPlugin(b)},Testimonial.prototype={initPlugin:function(a){this.createOptions(a),this.parseDomTree(),this.createSlides(),this.createInfrastructure(),this.slideRendering(),this.resizePluginContainer(),this.pluginOptions.autostart&&this.start()},start:function(){this.timerId=setInterval(function(){testimonial.next()},this.pluginOptions.timeout)},stop:function(){clearInterval(this.timerId),this.timerId=void 0},next:function(){void 0!==this.timerId&&this.stop();var a=this.$slides[this.currentSlideIndex];this.indexing();var b=this.$slides[this.currentSlideIndex];a.animateHide(),b.animateShow(),this.resizePluginContainer(),this.start()},createOptions:function(a){var b=this.getDefaultOptions();this.pluginOptions=$.extend(b,a)},getDefaultOptions:function(){var a={timeout:7e3,autostart:!0};return a},slideRendering:function(){for(var a=0;a<this.$slides.length;a++){var b=this.$slides[a];0!==a&&b.hideSlide(),this.$slidesWrapper.append(b.getNode())}},parseDomTree:function(){var a=this.$container.children();a.remove();var b=new Parser(a);this.dataArr=b.parse()},createSlides:function(){for(var a=0;a<this.dataArr.length;a++){var b=this.dataArr[a],c=new TestimonialSlide(b);this.$slides.push(c)}},createInfrastructure:function(){this.$slidesWrapper=$("<div />",{"class":"main_container"}),this.$container.append(this.$slidesWrapper),this.createButtonNext()},createButtonNext:function(){var a=$("<div />",{"class":"next_slide"});a.click(function(){testimonial.next()}),this.$container.append(a)},resizePluginContainer:function(){var a=20,b=this.$slides[this.currentSlideIndex].height();this.$container.height(b+a)},indexing:function(){this.currentSlideIndex++,this.currentSlideIndex===this.$slides.length&&(this.currentSlideIndex=0)}},TestimonialSlide=function(a){this.data=a,this.$slide=$("<div />",{"class":"testimonial_slide"}),this.createOptions(),this.createSlide()},TestimonialSlide.prototype={createOptions:function(){this.options={duration:750,distance:250}},createSlide:function(){this.$slide.append(this.createQuoteNode()),this.$slide.append(this.createAuthorFotoNode())},createQuoteNode:function(){var a=$("<div />",{"class":"quote"});return a.append(this.createQuotationMark()),a.append(this.createTextNode()),a.append(this.createQuotationMarkInverted()),a.append(this.createSignatureNode()),a},createTextNode:function(){var a=$("<div />",{"class":"text"});return a.text(this.data.quote),a},createQuotationMark:function(){var a=$("<div />",{"class":"quotation_mark"});return a},createQuotationMarkInverted:function(){var a=$("<div />",{"class":"quotation_mark_inverted"});return a},createSignatureNode:function(){var a=$("<div />",{"class":"signature"});return a.append(this.createAuthorNode()),a.append(this.createCompanyNode()),a},createAuthorNode:function(){var a=$("<div />",{"class":"author"});return a.text("- "),a.append(this.createLinkNode(this.data.authorHref,this.data.fullName)),a},createCompanyNode:function(){var a=$("<div />",{"class":"company"});return a.append(this.createLinkNode(this.data.companyHref,this.data.company)),a},createLinkNode:function(a,b){var c=$("<a />",{target:"_blank",href:a,text:b});return c},createAuthorFotoNode:function(){var a=$("<img />",{"class":"author_foto",src:this.data.fotoSrc});return a},animateHide:function(){var a=this;this.$slide.animate({"margin-left":"+="+this.options.distance+"px",opacity:"0"},this.options.duration,function(){a.hideSlide()})},animateShow:function(){this.$slide.show().animate({"margin-left":"+="+this.options.distance+"px",opacity:"1"},2*this.options.duration)},hideSlide:function(){var a="display: none; opacity: 0;       margin-left: -"+this.options.distance+"px";this.$slide.attr("style",a)},height:function(){return this.$slide.height()},getNode:function(){return this.$slide}};